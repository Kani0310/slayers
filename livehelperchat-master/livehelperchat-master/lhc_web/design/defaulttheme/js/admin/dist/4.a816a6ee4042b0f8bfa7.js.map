{"version":3,"sources":["webpack://LHCReactAPPAdmin/./src/components/DashboardChatTabs.js"],"names":["reducer","state","action","type","foundIndex","chats","findIndex","x","id","value","attr","unshift","active","mn","support_chat","splice","msg","el","document","getElementById","classList","contains","group_offline","Error","DashboardChatTabs","props","useReducer","dispatch","chatsRef","useRef","useEffect","current","loadChatTabIntro","chatIds","axios","get","WWW_DIR_JAVASCRIPT","join","map","chat","index","push","getChatIds","then","result","data","nodeJSStatus","live_status","textContent","addTab","chatId","params","focus","addTabBackground","removeTab","tabClicked","chatAdminSync","lhinst","hidenicknamesstatus","Object","keys","result_status","key","chat_id","typingVisitor","tp","txt","typingVisitorStopped","nodeJsVisitorStatus","status","activateNextTab","chatid","up","length","chatTabClick","ee","addListener","unread","localStorage","achat_id","getItem","ids","split","entries","forEach","parseInt","setTimeout","removeListener","$","click","useTranslation","t","i18n","Fragment","className","title","onClick","us","um","cc","cn","src","alt","cs","nick","lmsg","e","preventDefault","stopPropagation","removeDialogTab","closeDialog","dep","co","confLH","user_id","tx"],"mappings":"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","file":"4.a816a6ee4042b0f8bfa7.js","sourcesContent":["import React, { useEffect, useState, useReducer, useRef } from \"react\";\nimport axios from \"axios\";\nimport {useTranslation} from 'react-i18next';\n\nfunction reducer(state, action) {\n    switch (action.type) {\n\n        case 'attr':\n            var foundIndex = state.chats.findIndex(x => x.id == action.id);\n            if (foundIndex === -1) return state;\n            state.chats[foundIndex] = { ...state.chats[foundIndex], ...action.value};\n            state = { ... state};\n            return state;\n\n        case 'attr_remove':\n            var foundIndex = state.chats.findIndex(x => x[action.attr] == action.id);\n            if (foundIndex === -1) return state;\n            state.chats[foundIndex] = { ...state.chats[foundIndex], ...action.value};\n            state = { ... state};\n            return state;\n\n        case 'update': {\n            return { ...state, ...action.value }\n        }\n\n        case 'add': {\n            var foundIndex = state.chats.findIndex(x => x.id == action.value.id);\n            if (foundIndex === -1) {\n                state.chats.unshift(action.value);\n            } else {\n                state.chats[foundIndex].active = true;\n                state.chats[foundIndex].mn = 0;\n                state.chats[foundIndex].support_chat = false;\n            }\n\n            return { ...state}\n        }\n\n        case 'remove': {\n            var foundIndex = state.chats.findIndex(x => x.id == action.id);\n            if (foundIndex === -1) return state;\n            state.chats.splice(foundIndex,1);\n            return { ...state}\n        }\n\n        case 'update_chat': {\n            var foundIndex = state.chats.findIndex(x => x.id == action.id);\n            if (foundIndex === -1) return state;\n            state.chats[foundIndex] = {...state.chats[foundIndex], ...action.value}\n            return { ...state}\n        }\n\n        case 'msg_received': {\n            var foundIndex = state.chats.findIndex(x => x.id == action.id);\n            if (foundIndex === -1) return state;\n\n            state.chats[foundIndex].msg = action.value.msg;\n\n            var el = document.getElementById('chat-tab-link-'+action.id);\n\n            if (el === null || !el.classList.contains('active')) {\n                state.chats[foundIndex].active = false;\n            } else {\n                state.chats[foundIndex].active = true;\n            }\n\n            state.chats[foundIndex].mn = state.chats[foundIndex].active == false ? (state.chats[foundIndex].mn ? (state.chats[foundIndex].mn + action.value.mn) : action.value.mn) : 0;\n\n            // Set last appended messages as first array element\n            state.chats.splice(0, 0, state.chats.splice(foundIndex, 1)[0]);\n\n            return { ...state}\n        }\n\n        case 'refocus': {\n            var foundIndex = state.chats.findIndex(x => x.active == true);\n            if (foundIndex !== -1) {\n                if (action.id == state.chats[foundIndex].id) {\n                    return state;\n                }\n                state.chats[foundIndex].active = false;\n            }\n\n            var foundIndex = state.chats.findIndex(x => x.id == action.id);\n            if (foundIndex !== -1) {\n                state.chats[foundIndex].active = true;\n                state.chats[foundIndex].mn = 0;\n                state.chats[foundIndex].support_chat = false;\n            }\n\n            return { ...state}\n        }\n\n        case 'group_offline':\n            state.group_offline = action.value;\n            return {...state};\n\n        default:\n            throw new Error('Unknown action!');\n    }\n}\n\nconst DashboardChatTabs = props => {\n\n    const [state, dispatch] = useReducer(reducer, {\n        chats: [],\n        group_offline : false\n    });\n\n    const chatsRef = useRef(state);\n\n    useEffect(\n        () => { chatsRef.current = state },\n        [state]\n    )\n\n    const getChatIds = () => {\n        var chatIds = [];\n        state.chats.map((chat, index) => chatIds.push(chat.id));\n        return chatIds;\n    }\n\n    const loadChatTabIntro = (chatIds) => {\n        axios.get(WWW_DIR_JAVASCRIPT  + \"front/tabs/(id)/\" + (typeof chatIds !== 'undefined' ? chatIds.join('/') : getChatIds().join('/'))).then(result => {\n            result.data.map((chat, index) => {\n\n                // If nodeJS extension is enabled check chat live status\n                // As on page reload react app can be yet not started and we might not receive event\n                // at that moment react app starts\n                var nodeJSStatus = document.getElementById('node-js-indicator-'+chat.id);\n                if (nodeJSStatus !== null) {\n                    chat.live_status = nodeJSStatus.textContent == 'wifi';\n                }\n\n                dispatch({\n                    type: 'update_chat',\n                    id: chat.id,\n                    value: chat\n                })\n\n            })\n        });\n    }\n\n    useEffect(() => {\n\n        function addTab(chatId, params) {\n            if (params.focus) {\n                dispatch({\n                    type: 'attr_remove',\n                    id: true,\n                    attr: 'active',\n                    value: {\n                        \"active\" : false\n                    }\n                });\n            }\n\n            dispatch({\n                type: 'add',\n                value: {\n                    \"id\" : chatId,\n                    active: params.focus\n                }\n            });\n            loadChatTabIntro([chatId]);\n        }\n\n        function addTabBackground(chatId, params) {\n            dispatch({\n                type: 'add',\n                value: {\n                    \"id\" : chatId,\n                    active: false,\n                    mn : 1\n                }\n            });\n            loadChatTabIntro([chatId]);\n        }\n\n        function removeTab(chatId) {\n            dispatch({\n                type: 'remove',\n                id: chatId\n            });\n        }\n\n        function tabClicked(chatId) {\n            dispatch({\n                type: 'refocus',\n                id: chatId\n            });\n        }\n\n        function chatAdminSync(data) {\n\n            dispatch({\n                type: 'group_offline',\n                value: lhinst.hidenicknamesstatus\n            })\n\n            Object.keys(data.result_status).map((key) => {\n                dispatch({\n                    type: 'update_chat',\n                    id: data.result_status[key].chat_id,\n                    value: data.result_status[key]\n                })\n            });\n\n            if (data.result !== 'false') {\n                Object.keys(data.result).map((key) => {\n                    dispatch({\n                        type: 'msg_received',\n                        id: data.result[key].chat_id,\n                        value: {msg: data.result[key].msg, mn: data.result[key].mn}\n                    })\n                });\n            }\n        }\n\n        function supportUnreadChat(params) {\n            if (params.id && params.unread == true) {\n                dispatch({\n                    type: 'update_chat',\n                    id: params.id,\n                    value: {support_chat: true}\n                })\n            }\n        }\n\n        function typingVisitor(params) {\n            dispatch({\n                type: 'update_chat',\n                id: params.id,\n                value: {tp: 'true','tx' : params.txt}\n            })\n        }\n\n        function typingVisitorStopped(params) {\n            dispatch({\n                type: 'update_chat',\n                id: params.id,\n                value: {tp: 'false'}\n            })\n        }\n\n        function nodeJsVisitorStatus(params) {\n            dispatch({\n                type: 'update_chat',\n                id: params.id,\n                value: {live_status: params.status}\n            })\n        }\n\n        function activateNextTab(chatid,up) {\n            var index = chatsRef.current.chats.findIndex(x => x.active == true);\n            if (index === -1) { return; }\n            if ((chatsRef.current.chats.length - 1) > index && up == false) {\n                chatTabClick(chatsRef.current.chats[index + 1]);\n            } else if (index > 0 && up == true) {\n                chatTabClick(chatsRef.current.chats[index - 1]);\n            }\n        }\n\n        ee.addListener('chatStartTab',addTab)\n        ee.addListener('chatStartBackground',addTabBackground)\n        ee.addListener('removeSynchroChat',removeTab)\n        ee.addListener('chatTabClicked',tabClicked)\n        ee.addListener('chatTabFocused',tabClicked)\n        ee.addListener('chatAdminSync',chatAdminSync)\n        ee.addListener('supportUnreadChat',supportUnreadChat)\n        ee.addListener('nodeJsTypingVisitor',typingVisitor)\n        ee.addListener('nodeJsTypingVisitorStopped',typingVisitorStopped)\n        ee.addListener('nodeJsVisitorStatus',nodeJsVisitorStatus)\n        ee.addListener('activateNextTab',activateNextTab)\n\n        if (localStorage) {\n            var achat_id = localStorage.getItem('achat_id');\n            if (achat_id !== null && achat_id !== '') {\n                var ids = achat_id.split(',');\n                var entries = [];\n                ids.forEach((id) => {\n                   var el = document.getElementById('chat-tab-link-'+id);\n                   if (el !== null) {\n                       var active = el.classList.contains('active');\n                       entries.push({id: parseInt(id), active: active})\n                   }\n               });\n               dispatch({\n                    type: 'update',\n                    value: {\n                        \"chats\" : entries\n                    }\n                });\n               ids.length > 0 && loadChatTabIntro(ids);\n\n               // Find active chat\n               setTimeout(() => {\n                   ids.forEach((id) => {\n                       var el = document.getElementById('chat-tab-link-'+id);\n                       if (el !== null) {\n                           el.classList.contains('active') && tabClicked(parseInt(id));\n                       }\n                   });\n               },1000);\n            }\n         }\n\n        // Cleanup\n        return function cleanup() {\n            ee.removeListener('chatStartTab', addTab);\n            ee.removeListener('chatStartBackground', addTabBackground);\n            ee.removeListener('removeSynchroChat', removeTab);\n            ee.removeListener('chatTabClicked', tabClicked);\n            ee.removeListener('chatTabFocused', tabClicked);\n            ee.removeListener('chatAdminSync', chatAdminSync);\n            ee.removeListener('supportUnreadChat', chatAdminSync);\n            ee.removeListener('nodeJsTypingVisitor', typingVisitor);\n            ee.removeListener('nodeJsTypingVisitorStopped', typingVisitorStopped);\n            ee.removeListener('nodeJsVisitorStatus', nodeJsVisitorStatus);\n            ee.removeListener('activateNextTab', activateNextTab);\n        };\n\n    },[]);\n\n    const chatTabClick = (chat) => {\n        $('#chat-tab-link-'+chat.id).click();\n    }\n\n    const closeDialog = (e,chat) => {\n        e.preventDefault();\n        e.stopPropagation();\n        lhinst.removeDialogTab(chat.id,$('#tabs'),true);\n    }\n\n    const { t, i18n } = useTranslation('chat_tabs');\n\n    return (\n        <React.Fragment>\n            {(!state.chats || state.chats.length == 0) && <div className=\"text-center text-muted p-2\"><span className=\"material-icons\">chat</span>{t('chat_tabs.open_chats')}</div>}\n            {state.chats.map((chat, index) => (\n                <div title={chat.id} onClick={() => chatTabClick(chat)} className={\"p-1 action-image chat-tabs-row\"+(chat.active ? ' chat-tab-active' : '')}>\n                        <div className=\"fs12\">\n                            {chat.support_chat && <span className=\"whatshot blink-ani text-warning material-icons\">whatshot</span>}<i className={\"material-icons \"+(typeof chat.live_status === \"boolean\" ? (chat.live_status === true ? 'icon-user-online' : 'icon-user-offline') : (chat.us == 2 ? \"icon-user-away\" : (chat.us == 0 ? \"icon-user-online\" : \"icon-user-offline\")))}  >face</i><i className={\"material-icons icon-user-online \" + (chat.um == 1 ? \"icon-user-offline\" : \"icon-user-online\")}>send</i>{chat.cc && <img title={chat.cn} src={chat.cc} alt=\"\" />} {(state.group_offline == false || !(chat.us != 0)) && <span className={(chat.mn > 0 ? \"font-weight-bold \" : '') + (chat.cs == 0 ? 'text-warning' : '')}>{chat.nick || chat.id}</span>}{chat.mn > 0 && <span className=\"msg-nm pl-1\">({chat.mn})</span>}{chat.lmsg && <span className=\"text-muted\"> {chat.lmsg}</span>}\n                            <button type=\"button\" onClick={(e) => closeDialog(e,chat)} className=\"float-right btn-link m-0 ml-1 p-0 btn btn-xs\"><i className=\"material-icons mr-0\">close</i></button>\n                            {chat.dep && <span className=\"float-right text-muted text-truncate mw-80px\"><span className=\"material-icons\">home</span>{chat.dep}</span>}\n                            {chat.co == confLH.user_id && <span className=\"float-right text-muted\"><span title={t('chat_tabs.chat_owner')} className=\"material-icons\">account_box</span></span>}\n                        </div>\n\n                        {(chat.msg || (chat.tp == 'true' && chat.tx)) && <div className=\"fs13 text-muted pt-1\">\n                            <span title={chat.tp == 'true' && chat.tx ? chat.tx : chat.msg} className={\"d-inline-block text-truncate mw-100 \"+(chat.mn > 0 ? 'font-weight-bold' : '')+(chat.tp == 'true' && chat.tx ? ' font-italic': '')}>\n                                {chat.tp == 'true' && chat.tx ? chat.tx : chat.msg}\n                            </span>\n                        </div>}\n                </div>\n            ))}\n        </React.Fragment>\n    );\n}\n\nexport default DashboardChatTabs"],"sourceRoot":""}